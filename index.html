<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio‚ÄëReact ¬∑ Living Human Game | Auto‚ÄëRig, Physics, Biology</title>
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üß¨</text></svg>">
    <meta name="description" content="Next‚Äëgen auto‚Äërigging, real‚Äëtime IK, physics‚Äëbased ragdoll, and biological animations.">
    <meta name="keywords" content="3D, auto-rigging, inverse kinematics, physics, ragdoll, biological, Three.js">
    <meta name="author" content="Bio‚ÄëReact Team">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Bio‚ÄëReact ¬∑ Living Human Game">
    <meta property="og:description" content="Auto‚Äërigging, physics, and biology for any uploaded mesh.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/0A0A0F/00FFFF?text=Bio‚ÄëReact">
    
    <!-- Styles (same as before ‚Äì keep intact) -->
    <style>
        /* ----- (keep all existing CSS exactly as in the provided code) ----- */
        * { margin:0; padding:0; box-sizing:border-box; }
        :root {
            --bg-dark: #0A0A0F; --bg-darker: #050508; --bg-gradient-start: #0A0A0F; --bg-gradient-end: #1A1A2A;
            --accent-cyan: #00FFFF; --accent-cyan-dark: #00CCCC; --accent-violet: #8A2BE2; --accent-violet-dark: #6B1FA3;
            --accent-pink: #FF44CC; --accent-pink-dark: #CC33AA; --accent-green: #44FF44; --accent-red: #FF4444;
            --accent-yellow: #FFAA44; --glass-bg: rgba(10,10,15,0.25); --glass-bg-hover: rgba(20,20,30,0.35);
            --glass-border: rgba(0,255,255,0.15); --glass-border-hover: rgba(0,255,255,0.3);
            --blur-sm: blur(10px); --blur-md: blur(20px); --blur-lg: blur(40px);
            --glow-cyan: 0 0 30px rgba(0,255,255,0.6); --glow-violet: 0 0 30px rgba(138,43,226,0.6);
            --glow-pink: 0 0 30px rgba(255,68,204,0.6);
            --text-primary: #F0F0FF; --text-secondary: #C0C0E0; --text-dim: #A0A0C0; --text-muted: #707090;
            --text-glow: 0 0 10px rgba(0,255,255,0.3); --text-glow-strong: 0 0 20px rgba(0,255,255,0.6);
            --shadow-sm: 0 5px 15px rgba(0,0,0,0.3); --shadow-md: 0 10px 30px rgba(0,0,0,0.5);
            --shadow-lg: 0 20px 60px rgba(0,0,0,0.8); --shadow-xl: 0 30px 90px rgba(0,0,0,0.9);
            --transition-fast: all 0.2s cubic-bezier(0.25,0.46,0.45,0.94);
            --transition-normal: all 0.3s cubic-bezier(0.25,0.46,0.45,0.94);
            --transition-slow: all 0.5s cubic-bezier(0.16,1,0.3,1);
            --transition-spring: all 0.6s cubic-bezier(0.68,-0.55,0.265,1.55);
            --border-radius-sm: 12px; --border-radius-md: 24px; --border-radius-lg: 40px; --border-radius-xl: 60px;
            --border-radius-circle: 50%;
            --font-family-heading: 'Orbitron', sans-serif;
            --font-family-body: 'Inter', sans-serif;
            --font-family-mono: 'JetBrains Mono', monospace;
            --z-index-canvas: 0; --z-index-background: 1; --z-index-content: 10; --z-index-header: 100;
            --z-index-panel: 150; --z-index-drawer: 200; --z-index-toast: 1000; --z-index-loading: 2000;
            --z-index-diagnostic: 2500;
        }
        body {
            font-family: var(--font-family-body); background: var(--bg-dark); color: var(--text-primary);
            overflow-x: hidden; line-height: 1.6; min-height: 100vh; position: relative;
            -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility;
        }
        body::before {
            content: ''; position: fixed; top:0; left:0; width:100%; height:100%;
            background: radial-gradient(circle at 20%30%, rgba(138,43,226,0.15)0%, transparent 50%),
                        radial-gradient(circle at 80%70%, rgba(0,255,255,0.15)0%, transparent 50%),
                        radial-gradient(circle at 40%80%, rgba(255,68,204,0.1)0%, transparent 50%);
            pointer-events: none; z-index: var(--z-index-background); animation: backgroundPulse 10s ease-in-out infinite alternate;
        }
        @keyframes backgroundPulse { 0%{opacity:0.5;transform:scale(1);} 100%{opacity:1;transform:scale(1.1);} }
        h1,h2,h3,h4,h5,h6 { font-family: var(--font-family-heading); font-weight:700; letter-spacing:1px; line-height:1.3; }
        a { color: var(--accent-cyan); text-decoration:none; transition: var(--transition-normal); }
        a:hover { color: var(--accent-violet); text-shadow: var(--text-glow); }
        ::-webkit-scrollbar { width:8px; height:8px; }
        ::-webkit-scrollbar-track { background: var(--glass-bg); border-radius: var(--border-radius-lg); }
        ::-webkit-scrollbar-thumb { background: var(--accent-cyan); border-radius: var(--border-radius-lg); box-shadow: var(--glow-cyan); }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-violet); box-shadow: var(--glow-violet); }
        ::selection { background: var(--accent-cyan); color: var(--bg-dark); text-shadow:none; }
        .glass { background: var(--glass-bg); backdrop-filter: var(--blur-md); border:1px solid var(--glass-border); border-radius:var(--border-radius-md); box-shadow:var(--shadow-md); transition:var(--transition-normal); }
        .glass:hover { background: var(--glass-bg-hover); border-color: var(--glass-border-hover); box-shadow:var(--shadow-lg); }
        .text-gradient { background: linear-gradient(135deg, var(--accent-cyan), var(--accent-violet), var(--accent-pink)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
        .text-glow { text-shadow: var(--text-glow); }
        .text-glow-strong { text-shadow: var(--text-glow-strong); }
        .no-select { user-select:none; }
        #diagnostic-panel { position:fixed; bottom:20px; left:20px; z-index:var(--z-index-diagnostic); background:rgba(0,0,0,0.9); backdrop-filter:var(--blur-lg); border:1px solid var(--glass-border); border-radius:var(--border-radius-lg); padding:15px; max-width:350px; font-family:var(--font-family-mono); font-size:0.8rem; color:var(--text-dim); display:none; box-shadow:var(--shadow-xl); }
        #diagnostic-panel.show { display:block; animation:slideIn 0.3s ease; }
        @keyframes slideIn { from{transform:translateX(-100%);opacity:0;} to{transform:translateX(0);opacity:1;} }
        .diagnostic-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; padding-bottom:10px; border-bottom:1px solid var(--glass-border); }
        .diagnostic-title { color:var(--accent-cyan); font-weight:600; text-transform:uppercase; letter-spacing:1px; }
        .diagnostic-close { cursor:pointer; color:var(--text-dim); transition:var(--transition-fast); }
        .diagnostic-close:hover { color:var(--accent-red); }
        .diagnostic-item { display:flex; justify-content:space-between; margin-bottom:8px; padding:5px; border-radius:var(--border-radius-sm); transition:var(--transition-fast); }
        .diagnostic-item:hover { background:rgba(255,255,255,0.05); }
        .diagnostic-label { color:var(--text-secondary); }
        .diagnostic-value { font-weight:600; }
        .diagnostic-value.success { color:var(--accent-green); }
        .diagnostic-value.warning { color:var(--accent-yellow); }
        .diagnostic-value.error { color:var(--accent-red); }
        .diagnostic-info { margin-top:10px; padding-top:10px; border-top:1px solid var(--glass-border); }
        .diagnostic-log { max-height:200px; overflow-y:auto; font-size:0.7rem; color:var(--text-muted); padding:5px; background:rgba(0,0,0,0.3); border-radius:var(--border-radius-sm); }
        .diagnostic-log-entry { padding:2px 0; border-bottom:1px dashed rgba(255,255,255,0.1); }
        .diagnostic-log-entry.error { color:var(--accent-red); }
        .diagnostic-log-entry.warning { color:var(--accent-yellow); }
        .diagnostic-log-entry.success { color:var(--accent-green); }
        #error-boundary { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg-dark); z-index:10000; display:flex; align-items:center; justify-content:center; padding:20px; opacity:0; pointer-events:none; transition:opacity 0.5s; }
        #error-boundary.show { opacity:1; pointer-events:auto; }
        .error-content { max-width:600px; background:var(--glass-bg); backdrop-filter:var(--blur-lg); border:1px solid var(--accent-red); border-radius:var(--border-radius-lg); padding:40px; text-align:center; box-shadow:var(--shadow-xl); }
        .error-icon { font-size:4rem; margin-bottom:20px; color:var(--accent-red); }
        .error-title { font-size:2rem; color:var(--accent-red); margin-bottom:15px; }
        .error-message { color:var(--text-dim); margin-bottom:25px; line-height:1.8; }
        .error-details { background:rgba(0,0,0,0.3); padding:15px; border-radius:var(--border-radius-md); margin-bottom:25px; text-align:left; font-family:var(--font-family-mono); font-size:0.9rem; color:var(--text-muted); overflow-x:auto; }
        .error-button { background:var(--accent-red); color:white; border:none; padding:12px 30px; border-radius:var(--border-radius-lg); font-size:1rem; cursor:pointer; transition:var(--transition-normal); font-weight:600; }
        .error-button:hover { transform:scale(1.05); box-shadow:0 0 30px var(--accent-red); }
        #canvas-container { position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:var(--z-index-canvas); pointer-events:auto; background:radial-gradient(ellipse at center, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%); }
        .glass-header { position:fixed; top:20px; left:20px; right:20px; padding:12px 32px; display:flex; justify-content:space-between; align-items:center; z-index:var(--z-index-header); background:var(--glass-bg); backdrop-filter:var(--blur-lg); border:1px solid var(--glass-border); border-radius:var(--border-radius-xl); box-shadow:var(--shadow-lg); animation:slideDown 0.5s ease-out; }
        @keyframes slideDown { from{transform:translateY(-100%);opacity:0;} to{transform:translateY(0);opacity:1;} }
        .logo { font-family:var(--font-family-heading); font-size:1.6rem; font-weight:800; background:linear-gradient(135deg,var(--accent-cyan),var(--accent-violet)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; filter:drop-shadow(0 0 20px rgba(0,255,255,0.5)); letter-spacing:2px; position:relative; }
        .logo::after { content:'‚Ñ¢'; font-size:0.7rem; position:absolute; top:-5px; right:-20px; color:var(--accent-pink); font-weight:400; }
        nav { display:flex; gap:30px; }
        .nav-link { color:var(--text-secondary); text-decoration:none; font-weight:500; font-size:0.95rem; text-transform:uppercase; letter-spacing:1.5px; padding:8px 16px; border-radius:var(--border-radius-lg); transition:var(--transition-normal); position:relative; overflow:hidden; }
        .nav-link::before { content:''; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:0; height:0; border-radius:50%; background:rgba(0,255,255,0.2); transition:width 0.6s, height 0.6s; z-index:-1; }
        .nav-link:hover { color:var(--accent-cyan); text-shadow:var(--text-glow); }
        .nav-link:hover::before { width:200px; height:200px; }
        .nav-link.active { color:var(--accent-cyan); border-bottom:2px solid var(--accent-cyan); }
        .profile-chip { display:flex; align-items:center; gap:15px; padding:6px 20px 6px 12px; background:rgba(255,255,255,0.05); border-radius:var(--border-radius-xl); border:1px solid var(--glass-border); cursor:pointer; transition:var(--transition-normal); position:relative; overflow:hidden; }
        .profile-chip::before { content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:conic-gradient(transparent, var(--accent-cyan), transparent, var(--accent-violet), transparent); opacity:0; transition:opacity 0.5s; animation:rotate 4s linear infinite; }
        .profile-chip:hover { border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); }
        .profile-chip:hover::before { opacity:0.3; }
        @keyframes rotate { from{transform:rotate(0deg);} to{transform:rotate(360deg);} }
        .avatar { width:40px; height:40px; border-radius:var(--border-radius-circle); background:linear-gradient(45deg,var(--accent-cyan),var(--accent-violet)); display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:1.4rem; color:white; box-shadow:var(--glow-cyan); position:relative; z-index:1; }
        .xp-info { font-size:0.85rem; line-height:1.4; position:relative; z-index:1; }
        .level { color:var(--accent-cyan); font-weight:700; text-transform:uppercase; font-size:0.7rem; letter-spacing:1px; }
        #xp-value { font-weight:700; font-size:1rem; color:var(--text-primary); }
        #menu-dots { background:none; border:none; color:var(--text-primary); font-size:1.8rem; cursor:pointer; padding:0 8px; transition:transform 0.5s; line-height:1; filter:drop-shadow(0 0 10px transparent); }
        #menu-dots:hover { transform:rotate(180deg) scale(1.2); color:var(--accent-cyan); filter:drop-shadow(0 0 20px var(--accent-cyan)); }
        .drawer { position:fixed; top:0; right:-450px; width:420px; height:100vh; background:var(--glass-bg); backdrop-filter:blur(50px); border-left:1px solid var(--glass-border); box-shadow:var(--shadow-xl); z-index:var(--z-index-drawer); transition:right 0.5s cubic-bezier(0.16,1,0.3,1); padding:100px 30px 30px; overflow-y:auto; }
        .drawer.open { right:0; }
        .drawer-close { position:absolute; top:30px; right:30px; background:none; border:none; color:var(--text-primary); font-size:2.5rem; cursor:pointer; transition:var(--transition-normal); width:50px; height:50px; display:flex; align-items:center; justify-content:center; border-radius:var(--border-radius-circle); background:var(--glass-bg); backdrop-filter:var(--blur-md); border:1px solid var(--glass-border); }
        .drawer-close:hover { transform:rotate(90deg) scale(1.2); color:var(--accent-cyan); border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); }
        .drawer-section { margin-bottom:45px; animation:fadeInRight 0.5s ease-out forwards; opacity:0; }
        .drawer-section:nth-child(1){ animation-delay:0.1s; }
        .drawer-section:nth-child(2){ animation-delay:0.2s; }
        .drawer-section:nth-child(3){ animation-delay:0.3s; }
        .drawer-section:nth-child(4){ animation-delay:0.4s; }
        .drawer-section:nth-child(5){ animation-delay:0.5s; }
        @keyframes fadeInRight { from{opacity:0; transform:translateX(50px);} to{opacity:1; transform:translateX(0);} }
        .drawer-section h3 { color:var(--accent-cyan); margin-bottom:25px; border-bottom:2px solid var(--glass-border); padding-bottom:15px; font-size:1.2rem; letter-spacing:2px; text-transform:uppercase; position:relative; }
        .drawer-section h3::after { content:''; position:absolute; bottom:-2px; left:0; width:50px; height:2px; background:var(--accent-cyan); box-shadow:var(--glow-cyan); }
        .preset-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
        .preset-btn { background:rgba(0,0,0,0.4); border:1px solid var(--glass-border); color:var(--text-secondary); padding:12px; border-radius:40px; cursor:pointer; transition:var(--transition-normal); font-size:0.85rem; text-transform:uppercase; letter-spacing:1px; font-weight:600; backdrop-filter:var(--blur-sm); }
        .preset-btn:hover { border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); transform:translateY(-3px); color:var(--text-primary); background:rgba(0,0,0,0.6); }
        .preset-btn.active { background:linear-gradient(135deg,var(--accent-cyan),var(--accent-violet)); color:var(--bg-dark); border-color:transparent; box-shadow:var(--glow-cyan); }
        .setting-item { display:flex; align-items:center; justify-content:space-between; background:rgba(0,0,0,0.3); padding:15px 20px; border-radius:50px; border:1px solid var(--glass-border); margin-bottom:15px; }
        .setting-label { color:var(--text-secondary); font-weight:500; }
        .setting-value { color:var(--accent-cyan); font-weight:600; }
        .achievement-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:15px; }
        .achievement-item { text-align:center; padding:20px 10px; background:rgba(0,0,0,0.3); border-radius:20px; border:1px solid var(--glass-border); transition:var(--transition-normal); backdrop-filter:var(--blur-sm); }
        .achievement-item:hover { border-color:var(--accent-cyan); transform:scale(1.05) translateY(-5px); box-shadow:var(--glow-cyan); }
        .achievement-item.locked { opacity:0.5; filter:grayscale(0.8); }
        .achievement-item.unlocked { border-color:var(--accent-green); }
        .achievement-icon { font-size:2.5rem; margin-bottom:10px; filter:drop-shadow(0 0 10px currentColor); }
        .achievement-title { font-size:0.8rem; text-transform:uppercase; color:var(--text-dim); font-weight:600; letter-spacing:0.5px; }
        .quest-list { list-style:none; background:rgba(0,0,0,0.3); border-radius:30px; padding:20px; }
        .quest-item { margin-bottom:20px; display:flex; align-items:center; gap:15px; padding:10px; border-radius:15px; transition:var(--transition-normal); }
        .quest-item:hover { background:rgba(255,255,255,0.05); }
        .quest-checkbox { width:24px; height:24px; border:2px solid var(--glass-border); border-radius:8px; display:flex; align-items:center; justify-content:center; color:var(--accent-cyan); font-size:1.2rem; transition:var(--transition-normal); }
        .quest-item.completed .quest-checkbox { background:var(--accent-cyan); border-color:var(--accent-cyan); color:var(--bg-dark); }
        .quest-info { flex:1; }
        .quest-title { font-weight:600; margin-bottom:5px; }
        .quest-progress { height:4px; background:rgba(255,255,255,0.1); border-radius:2px; overflow:hidden; width:100%; }
        .quest-progress-bar { height:100%; background:linear-gradient(90deg,var(--accent-cyan),var(--accent-violet)); width:0%; transition:width 0.3s; }
        .quest-reward { color:var(--accent-pink); font-weight:600; font-size:0.85rem; }
        .diagnostic-tool { background:rgba(0,0,0,0.3); border-radius:30px; padding:20px; margin-top:20px; }
        .diagnostic-row { display:flex; justify-content:space-between; margin-bottom:10px; padding:8px; background:rgba(0,0,0,0.2); border-radius:var(--border-radius-sm); }
        .diagnostic-row span:first-child { color:var(--text-secondary); }
        .diagnostic-row span:last-child { font-weight:600; }
        .diagnostic-button { width:100%; padding:12px; margin-top:10px; background:linear-gradient(135deg,var(--accent-cyan),var(--accent-violet)); border:none; border-radius:var(--border-radius-lg); color:var(--bg-dark); font-weight:600; cursor:pointer; transition:var(--transition-normal); }
        .diagnostic-button:hover { transform:translateY(-2px); box-shadow:var(--glow-cyan); }
        main { position:relative; z-index:var(--z-index-content); pointer-events:none; }
        section { min-height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:100px 20px; pointer-events:none; }
        section .content { max-width:1300px; width:100%; pointer-events:auto; background:var(--glass-bg); backdrop-filter:var(--blur-lg); border:1px solid var(--glass-border); border-radius:50px; padding:70px; box-shadow:var(--shadow-xl); transform:translateY(50px); opacity:0; transition:transform 1s cubic-bezier(0.16,1,0.3,1), opacity 1s ease; }
        section.visible .content { transform:translateY(0); opacity:1; }
        #hero .content { text-align:center; background:transparent; backdrop-filter:none; border:none; box-shadow:none; }
        #hero h1 { font-size:clamp(3.5rem,12vw,8rem); background:linear-gradient(135deg,var(--accent-cyan),var(--accent-violet),var(--accent-pink)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; margin-bottom:25px; animation:floatIn 1.2s ease-out; filter:drop-shadow(0 0 50px rgba(138,43,226,0.5)); text-transform:uppercase; letter-spacing:5px; }
        #hero .subtitle { font-size:1.8rem; margin-bottom:30px; color:var(--text-secondary); max-width:900px; margin-left:auto; margin-right:auto; animation:fadeInUp 1s ease-out 0.2s both; line-height:1.5; }
        #hero .tagline { font-size:1.2rem; margin-bottom:50px; color:var(--text-dim); max-width:700px; margin-left:auto; margin-right:auto; animation:fadeInUp 1s ease-out 0.3s both; }
        @keyframes floatIn { 0%{opacity:0; transform:scale(0.8) translateY(30px);} 100%{opacity:1; transform:scale(1) translateY(0);} }
        .button-group { display:flex; gap:25px; justify-content:center; flex-wrap:wrap; animation:fadeInUp 1s ease-out 0.4s both; }
        .btn { padding:16px 42px; border-radius:50px; font-weight:600; text-decoration:none; transition:var(--transition-spring); border:2px solid transparent; cursor:pointer; font-size:1.1rem; letter-spacing:1px; position:relative; overflow:hidden; text-transform:uppercase; box-shadow:var(--shadow-md); }
        .btn::before { content:''; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:0; height:0; border-radius:50%; background:rgba(255,255,255,0.2); transition:width 0.6s, height 0.6s; }
        .btn:hover::before { width:300px; height:300px; }
        .btn:active { transform:scale(0.95); }
        .btn-primary { background:linear-gradient(135deg,var(--accent-cyan),var(--accent-violet)); color:var(--bg-dark); box-shadow:var(--glow-cyan); border-color:transparent; }
        .btn-primary:hover { transform:scale(1.05) translateY(-3px); box-shadow:var(--glow-violet); }
        .btn-outline { border-color:var(--accent-cyan); color:var(--text-primary); background:transparent; backdrop-filter:blur(10px); }
        .btn-outline:hover { background:rgba(0,255,255,0.1); box-shadow:var(--glow-cyan); border-color:var(--accent-violet); transform:scale(1.05) translateY(-3px); }
        .section-title { text-align:center; font-size:2.8rem; margin-bottom:30px; background:linear-gradient(135deg,var(--accent-cyan),var(--accent-violet)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; text-transform:uppercase; letter-spacing:3px; }
        .section-subtitle { text-align:center; color:var(--text-dim); font-size:1.2rem; margin-bottom:60px; max-width:700px; margin-left:auto; margin-right:auto; }
        .feature-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:40px; margin-top:50px; }
        .feature-card { background:rgba(0,0,0,0.4); border-radius:40px; padding:50px 35px; border:1px solid var(--glass-border); transition:var(--transition-spring); text-align:center; backdrop-filter:var(--blur-md); position:relative; overflow:hidden; }
        .feature-card::before { content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:radial-gradient(circle at center, rgba(0,255,255,0.1), transparent 70%); opacity:0; transition:opacity 0.5s; }
        .feature-card:hover { transform:translateY(-20px) scale(1.02); border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); }
        .feature-card:hover::before { opacity:1; }
        .feature-icon { font-size:4rem; margin-bottom:30px; filter:drop-shadow(0 0 20px var(--accent-cyan)); animation:float 3s ease-in-out infinite; }
        @keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-10px);} }
        .feature-card h3 { color:var(--accent-cyan); margin-bottom:20px; font-size:1.6rem; letter-spacing:1px; }
        .feature-card p { color:var(--text-dim); line-height:1.8; font-size:1rem; }
        .carousel-container { position:relative; margin:40px 0; }
        .carousel { display:flex; overflow-x:auto; gap:30px; padding:30px 10px; scroll-snap-type:x mandatory; scrollbar-width:thin; scrollbar-color:var(--accent-cyan) var(--glass-bg); -webkit-overflow-scrolling:touch; }
        .carousel-item { min-width:350px; height:450px; background:linear-gradient(145deg,rgba(0,0,0,0.7),rgba(30,30,50,0.8)); border-radius:40px; border:1px solid var(--glass-border); scroll-snap-align:start; display:flex; flex-direction:column; justify-content:flex-end; padding:35px; transition:var(--transition-spring); position:relative; overflow:hidden; backdrop-filter:var(--blur-sm); }
        .carousel-item::before { content:''; position:absolute; top:0; left:0; right:0; bottom:0; background:radial-gradient(circle at 30%30%, rgba(0,255,255,0.2), transparent 70%); opacity:0; transition:opacity 0.5s; }
        .carousel-item:hover { border-color:var(--accent-cyan); transform:scale(1.02) translateY(-10px); box-shadow:var(--glow-cyan); }
        .carousel-item:hover::before { opacity:1; }
        .carousel-item-content { position:relative; z-index:2; }
        .carousel-item-title { font-weight:700; color:var(--accent-cyan); font-size:1.5rem; margin-bottom:10px; text-shadow:0 0 15px rgba(0,0,0,0.5); }
        .carousel-item-subtitle { color:var(--text-secondary); font-size:0.95rem; margin-bottom:15px; }
        .carousel-item-stats { display:flex; gap:15px; color:var(--text-dim); font-size:0.85rem; }
        .carousel-item-stats span { display:flex; align-items:center; gap:5px; }
        .carousel-controls { display:flex; justify-content:center; gap:15px; margin-top:25px; }
        .carousel-control { width:50px; height:50px; border-radius:50%; background:var(--glass-bg); backdrop-filter:var(--blur-md); border:1px solid var(--glass-border); color:var(--text-primary); font-size:1.5rem; cursor:pointer; transition:var(--transition-normal); display:flex; align-items:center; justify-content:center; }
        .carousel-control:hover { border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); transform:scale(1.1); }
        #playground-panel { position:fixed; bottom:35px; left:50%; transform:translateX(-50%); width:1100px; max-width:95vw; background:var(--glass-bg); backdrop-filter:blur(50px); border:1px solid var(--glass-border); border-radius:80px; padding:20px 35px; display:flex; justify-content:space-between; align-items:center; gap:15px; z-index:var(--z-index-panel); box-shadow:var(--shadow-xl); pointer-events:auto; flex-wrap:wrap; animation:slideUp 0.5s ease-out 1s both; border-bottom:3px solid transparent; border-image:linear-gradient(90deg,var(--accent-cyan),var(--accent-violet),var(--accent-pink))1; }
        @keyframes slideUp { from{transform:translate(-50%,100%);opacity:0;} to{transform:translate(-50%,0);opacity:1;} }
        .panel-group { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
        #playground-panel button, #playground-panel select { background:rgba(0,0,0,0.6); border:1px solid var(--glass-border); color:var(--text-primary); padding:12px 20px; border-radius:50px; font-size:0.95rem; cursor:pointer; transition:var(--transition-normal); min-width:110px; font-weight:500; letter-spacing:0.5px; backdrop-filter:blur(10px); box-shadow:var(--shadow-sm); }
        #playground-panel select { appearance:none; background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300FFFF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>"); background-repeat:no-repeat; background-position:right 20px center; padding-right:45px; }
        #playground-panel button:disabled { opacity:0.3; cursor:not-allowed; pointer-events:none; filter:grayscale(1); }
        #playground-panel button:not(:disabled):hover, #playground-panel select:not(:disabled):hover { border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); transform:translateY(-3px); background:rgba(0,0,0,0.8); }
        #playground-panel .progress-container { width:150px; }
        #playground-panel .progress { width:100%; height:6px; background:rgba(255,255,255,0.1); border-radius:3px; overflow:hidden; box-shadow:inset 0 1px 3px rgba(0,0,0,0.3); }
        #playground-panel .progress-bar { height:100%; width:0%; background:linear-gradient(90deg,var(--accent-cyan),var(--accent-violet)); transition:width 0.3s; box-shadow:0 0 15px var(--accent-cyan); border-radius:3px; }
        #playground-panel #status-message { font-size:0.85rem; color:var(--text-dim); max-width:180px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; padding:0 10px; }
        .loading-spinner { display:inline-block; width:28px; height:28px; border:3px solid rgba(255,255,255,0.1); border-radius:50%; border-top-color:var(--accent-cyan); border-right-color:var(--accent-violet); animation:spin 0.8s linear infinite; margin-left:10px; box-shadow:0 0 20px rgba(0,255,255,0.3); }
        #xp-container { position:fixed; top:120px; left:25px; z-index:120; background:var(--glass-bg); backdrop-filter:var(--blur-md); border:1px solid var(--glass-border); border-radius:30px; padding:15px 25px; box-shadow:var(--shadow-lg); transition:var(--transition-normal); }
        #xp-container:hover { border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); }
        #xp-bar { width:220px; height:8px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden; margin-bottom:8px; }
        #xp-fill { height:100%; width:0%; background:linear-gradient(90deg,var(--accent-cyan),var(--accent-violet)); transition:width 0.3s ease; box-shadow:0 0 20px var(--accent-cyan); }
        #xp-text { font-size:0.8rem; color:var(--text-dim); letter-spacing:0.5px; display:flex; justify-content:space-between; }
        #xp-text span:first-child { color:var(--accent-cyan); font-weight:600; }
        #xp-text span:last-child { color:var(--text-primary); font-weight:700; }
        .runner { position:fixed; bottom:25px; left:-250px; width:250px; height:4px; background:linear-gradient(90deg,var(--accent-cyan),var(--accent-violet),var(--accent-pink),transparent); border-radius:2px; filter:drop-shadow(0 0 15px var(--accent-cyan)); pointer-events:auto; z-index:300; animation:run 15s linear infinite; cursor:pointer; opacity:0.7; transition:opacity 0.3s; }
        .runner:hover { opacity:1; filter:drop-shadow(0 0 25px var(--accent-cyan)); height:6px; }
        @keyframes run { 0%{left:-250px;} 100%{left:100%;} }
        .toast { position:fixed; bottom:120px; right:30px; background:var(--glass-bg); backdrop-filter:blur(50px); border:1px solid var(--accent-cyan); border-radius:60px; padding:18px 36px; color:var(--accent-cyan); font-weight:600; z-index:var(--z-index-toast); transform:translateY(150px); opacity:0; transition:transform 0.4s cubic-bezier(0.16,1,0.3,1), opacity 0.4s; box-shadow:var(--shadow-xl); font-size:1rem; letter-spacing:0.5px; max-width:400px; word-wrap:break-word; }
        .toast.show { transform:translateY(0); opacity:1; }
        .toast.error { border-color:var(--accent-red); color:#ff8888; box-shadow:0 0 30px rgba(255,68,68,0.3); }
        .toast.success { border-color:var(--accent-green); color:#88ff88; box-shadow:0 0 30px rgba(68,255,68,0.3); }
        .toast.warning { border-color:var(--accent-yellow); color:#ffcc88; }
        footer { background:rgba(0,0,0,0.8); backdrop-filter:var(--blur-lg); padding:60px 30px 30px; text-align:center; border-top:1px solid var(--glass-border); position:relative; z-index:10; }
        .footer-content { max-width:1200px; margin:0 auto; display:grid; grid-template-columns:repeat(4,1fr); gap:40px; text-align:left; margin-bottom:50px; }
        .footer-column h4 { color:var(--accent-cyan); margin-bottom:20px; font-size:1.1rem; }
        .footer-column ul { list-style:none; }
        .footer-column li { margin-bottom:12px; }
        .footer-column a { color:var(--text-dim); transition:var(--transition-normal); }
        .footer-column a:hover { color:var(--accent-cyan); padding-left:5px; }
        .footer-social { display:flex; gap:15px; margin-top:20px; }
        .social-icon { width:40px; height:40px; border-radius:50%; background:var(--glass-bg); border:1px solid var(--glass-border); display:flex; align-items:center; justify-content:center; color:var(--text-primary); font-size:1.2rem; transition:var(--transition-normal); }
        .social-icon:hover { border-color:var(--accent-cyan); box-shadow:var(--glow-cyan); transform:translateY(-5px); }
        .footer-bottom { border-top:1px solid var(--glass-border); padding-top:30px; color:var(--text-dim); font-size:0.9rem; }
        #loading-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg-dark); z-index:var(--z-index-loading); display:flex; align-items:center; justify-content:center; transition:opacity 1s; pointer-events:none; }
        #loading-overlay.hidden { opacity:0; pointer-events:none; }
        .loading-content { text-align:center; }
        .loading-spinner-large { width:80px; height:80px; border:4px solid rgba(255,255,255,0.1); border-top-color:var(--accent-cyan); border-right-color:var(--accent-violet); border-bottom-color:var(--accent-pink); border-radius:50%; animation:spin 1s linear infinite; margin-bottom:30px; box-shadow:0 0 50px rgba(0,255,255,0.3); }
        .loading-text { color:var(--text-primary); font-size:1.2rem; letter-spacing:2px; animation:pulse 1.5s ease-in-out infinite; }
        @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.5;} }
        @media (max-width:1024px) {
            .glass-header { padding:12px 20px; }
            nav { gap:15px; }
            .nav-link { font-size:0.8rem; padding:6px 10px; }
            .feature-grid { grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:25px; }
            .footer-content { grid-template-columns:repeat(2,1fr); }
        }
        @media (max-width:768px) {
            .glass-header { flex-wrap:wrap; padding:15px; border-radius:30px; }
            nav { order:3; width:100%; text-align:center; margin-top:15px; justify-content:center; flex-wrap:wrap; }
            #playground-panel { width:95%; padding:15px; bottom:15px; justify-content:center; }
            #playground-panel button, #playground-panel select { min-width:80px; padding:8px 12px; font-size:0.8rem; }
            #xp-container { left:10px; padding:10px 15px; }
            #xp-bar { width:150px; }
            .drawer { width:320px; padding:80px 20px 20px; }
            .section-title { font-size:2rem; }
            section .content { padding:40px 20px; }
            .carousel-item { min-width:280px; height:400px; }
            .footer-content { grid-template-columns:1fr; text-align:center; }
            .footer-social { justify-content:center; }
        }
        @media (max-width:480px) {
            #hero h1 { font-size:2.5rem; }
            .subtitle { font-size:1.2rem; }
            .btn { padding:12px 25px; font-size:0.9rem; width:100%; }
            .button-group { flex-direction:column; gap:15px; }
            #playground-panel { flex-direction:column; align-items:stretch; border-radius:40px; }
            #playground-panel button, #playground-panel select { width:100%; }
            .panel-group { width:100%; }
            .progress-container { width:100%; }
            .carousel-item { min-width:240px; height:350px; }
        }
    </style>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Orbitron:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner-large"></div>
            <div class="loading-text">INITIALIZING BIO‚ÄëREACT...</div>
        </div>
    </div>

    <!-- Error Boundary -->
    <div id="error-boundary">
        <div class="error-content">
            <div class="error-icon"><i class="fas fa-exclamation-triangle"></i></div>
            <div class="error-title">CRITICAL ERROR</div>
            <div class="error-message" id="error-message">An unexpected error has occurred.</div>
            <div class="error-details" id="error-details"></div>
            <button class="error-button" onclick="location.reload()"><i class="fas fa-sync-alt"></i> RELOAD PAGE</button>
        </div>
    </div>

    <!-- Diagnostic Panel -->
    <div id="diagnostic-panel">
        <div class="diagnostic-header">
            <span class="diagnostic-title"><i class="fas fa-stethoscope"></i> DIAGNOSTIC REPORT</span>
            <span class="diagnostic-close" onclick="document.getElementById('diagnostic-panel').classList.remove('show')"><i class="fas fa-times"></i></span>
        </div>
        <div class="diagnostic-item">
            <span class="diagnostic-label">System Status:</span>
            <span class="diagnostic-value" id="diag-system">Checking...</span>
        </div>
        <div class="diagnostic-item">
            <span class="diagnostic-label">IK Solver:</span>
            <span class="diagnostic-value" id="diag-ik">Checking...</span>
        </div>
        <div class="diagnostic-item">
            <span class="diagnostic-label">Physics:</span>
            <span class="diagnostic-value" id="diag-physics">Checking...</span>
        </div>
        <div class="diagnostic-item">
            <span class="diagnostic-label">Biology:</span>
            <span class="diagnostic-value" id="diag-biology">Active</span>
        </div>
        <div class="diagnostic-item">
            <span class="diagnostic-label">WebGL:</span>
            <span class="diagnostic-value" id="diag-webgl">Checking...</span>
        </div>
        <div class="diagnostic-item">
            <span class="diagnostic-label">Browser:</span>
            <span class="diagnostic-value" id="diag-browser">Checking...</span>
        </div>
        <div class="diagnostic-info">
            <div class="diagnostic-log" id="diagnostic-log">
                <div class="diagnostic-log-entry">[INFO] Diagnostic started...</div>
            </div>
        </div>
        <button class="diagnostic-button" onclick="window.BioReact?.runDiagnostics()"><i class="fas fa-sync-alt"></i> RUN DIAGNOSTICS</button>
    </div>

    <!-- Canvas container -->
    <div id="canvas-container"></div>

    <!-- Header -->
    <header class="glass-header">
        <div class="logo">‚ö° BIO‚ÄëREACT</div>
        <nav>
            <a href="#hero" class="nav-link">HOME</a>
            <a href="#features" class="nav-link">FEATURES</a>
            <a href="#showcase" class="nav-link">SHOWCASE</a>
            <a href="#playground" class="nav-link">PLAYGROUND</a>
            <a href="#community" class="nav-link">COMMUNITY</a>
        </nav>
        <div style="display: flex; align-items: center; gap: 15px;">
            <div class="profile-chip" id="profile-chip">
                <div class="avatar" id="avatar">üß¨</div>
                <div class="xp-info">
                    <span class="level" id="level-display">NEOPHYTE</span>
                    <span id="xp-value">0 XP</span>
                </div>
            </div>
            <button id="menu-dots"><i class="fas fa-cog"></i></button>
        </div>
    </header>

    <!-- Drawer (Settings & Achievements) -->
    <div id="drawer" class="drawer">
        <button class="drawer-close" id="drawer-close">‚úï</button>
        
        <div class="drawer-section">
            <h3>‚ú® LIGHTING PRESET</h3>
            <div class="preset-grid">
                <button class="preset-btn active" data-preset="cinematic">CINEMATIC</button>
                <button class="preset-btn" data-preset="neon">NEON</button>
                <button class="preset-btn" data-preset="shadow">SHADOW</button>
            </div>
        </div>

        <div class="drawer-section">
            <h3>‚öôÔ∏è RIGGING</h3>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                <button id="auto-rig-btn" class="preset-btn" style="flex:1;">‚ú® AUTO‚ÄëRIG</button>
                <button id="manual-rig-btn" class="preset-btn" style="flex:1;">üõ†Ô∏è MANUAL RIG</button>
            </div>
            <div style="margin-top:10px;">
                <select id="rig-profile" class="select-custom">
                    <option value="auto">Auto‚Äëdetect</option>
                    <option value="mixamo">Mixamo</option>
                    <option value="makehuman">MakeHuman</option>
                    <option value="blender">Blender</option>
                </select>
            </div>
        </div>

        <div class="drawer-section">
            <h3>üéµ AUDIO</h3>
            <div class="setting-item">
                <span class="setting-label">Master Volume</span>
                <input type="range" min="0" max="100" value="70" class="volume-slider" style="width: 150px; accent-color: var(--accent-cyan);">
            </div>
            <label style="display: flex; align-items: center; gap: 15px; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 50px; border: 1px solid var(--glass-border); margin-top: 15px;">
                <input type="checkbox" id="sound-toggle" checked style="width: 20px; height: 20px; accent-color: var(--accent-cyan);">
                <span class="setting-label">Ambient Sound</span>
            </label>
        </div>

        <div class="drawer-section">
            <h3>‚ö° PERFORMANCE</h3>
            <select id="performance-select" style="width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border); color: var(--text-primary); padding: 15px; border-radius: 50px;">
                <option value="low">Low (Power Saving)</option>
                <option value="medium" selected>Medium (Balanced)</option>
                <option value="high">High (Quality)</option>
                <option value="ultra">Ultra (Experimental)</option>
            </select>
        </div>

        <div class="drawer-section">
            <h3>üéØ QUESTS</h3>
            <ul class="quest-list">
                <li class="quest-item" data-quest="first-upload">
                    <div class="quest-checkbox">üî≤</div>
                    <div class="quest-info">
                        <div class="quest-title">First Upload</div>
                        <div class="quest-progress"><div class="quest-progress-bar" style="width: 0%"></div></div>
                    </div>
                    <div class="quest-reward">+50 XP</div>
                </li>
                <li class="quest-item" data-quest="auto-rig">
                    <div class="quest-checkbox">üî≤</div>
                    <div class="quest-info">
                        <div class="quest-title">Auto‚ÄëRig Master</div>
                        <div class="quest-progress"><div class="quest-progress-bar" style="width: 0%"></div></div>
                    </div>
                    <div class="quest-reward">+200 XP</div>
                </li>
                <li class="quest-item" data-quest="ik-pose">
                    <div class="quest-checkbox">üî≤</div>
                    <div class="quest-info">
                        <div class="quest-title">IK Virtuoso</div>
                        <div class="quest-progress"><div class="quest-progress-bar" style="width: 0%"></div></div>
                    </div>
                    <div class="quest-reward">+100 XP</div>
                </li>
                <li class="quest-item" data-quest="physics">
                    <div class="quest-checkbox">üî≤</div>
                    <div class="quest-info">
                        <div class="quest-title">Ragdoll Physics</div>
                        <div class="quest-progress"><div class="quest-progress-bar" style="width: 0%"></div></div>
                    </div>
                    <div class="quest-reward">+150 XP</div>
                </li>
                <li class="quest-item" data-quest="biology">
                    <div class="quest-checkbox">üî≤</div>
                    <div class="quest-info">
                        <div class="quest-title">Living Being</div>
                        <div class="quest-progress"><div class="quest-progress-bar" style="width: 0%"></div></div>
                    </div>
                    <div class="quest-reward">+200 XP</div>
                </li>
            </ul>
        </div>

        <div class="drawer-section">
            <h3>üèÜ ACHIEVEMENTS</h3>
            <div class="achievement-grid">
                <div class="achievement-item locked" data-achievement="rookie">
                    <div class="achievement-icon">üèÜ</div>
                    <div class="achievement-title">Rookie</div>
                </div>
                <div class="achievement-item locked" data-achievement="rigger">
                    <div class="achievement-icon">‚ö°</div>
                    <div class="achievement-title">Rigger</div>
                </div>
                <div class="achievement-item locked" data-achievement="puppeteer">
                    <div class="achievement-icon">ü¶æ</div>
                    <div class="achievement-title">Puppeteer</div>
                </div>
                <div class="achievement-item locked" data-achievement="physicist">
                    <div class="achievement-icon">üåä</div>
                    <div class="achievement-title">Physicist</div>
                </div>
                <div class="achievement-item locked" data-achievement="biologist">
                    <div class="achievement-icon">üß¨</div>
                    <div class="achievement-title">Biologist</div>
                </div>
                <div class="achievement-item locked" data-achievement="master">
                    <div class="achievement-icon">üëë</div>
                    <div class="achievement-title">Master</div>
                </div>
            </div>
        </div>

        <div class="drawer-section">
            <h3>‚ÑπÔ∏è SYSTEM INFO</h3>
            <div class="diagnostic-tool">
                <div class="diagnostic-row">
                    <span>Version:</span>
                    <span>3.0.0</span>
                </div>
                <div class="diagnostic-row">
                    <span>IK Library:</span>
                    <span id="drawer-ik-status">Checking...</span>
                </div>
                <div class="diagnostic-row">
                    <span>Physics:</span>
                    <span id="drawer-physics-status">Checking...</span>
                </div>
                <div class="diagnostic-row">
                    <span>Biology:</span>
                    <span style="color:#44ff44;">Active</span>
                </div>
                <button class="diagnostic-button" onclick="window.BioReact?.showDiagnosticPanel()"><i class="fas fa-stethoscope"></i> FULL DIAGNOSTICS</button>
            </div>
        </div>
    </div>

    <!-- Main sections -->
    <main>
        <!-- Hero -->
        <section id="hero">
            <div class="content">
                <h1>BIO‚ÄëREACT</h1>
                <div class="subtitle">Where Characters Come Alive</div>
                <div class="tagline">Auto‚ÄëRigging ‚Ä¢ Physics ‚Ä¢ Biology ‚Ä¢ Real‚ÄëTime IK</div>
                <div class="button-group">
                    <button class="btn btn-primary" id="enter-playground"><i class="fas fa-rocket"></i> ENTER PLAYGROUND</button>
                    <button class="btn btn-outline" id="watch-showreel"><i class="fas fa-play"></i> WATCH SHOWREEL</button>
                </div>
            </div>
        </section>

        <!-- Features -->
        <section id="features">
            <div class="content">
                <h2 class="section-title">POWERED BY NEXT‚ÄëGEN AI</h2>
                <div class="section-subtitle">Science, Math, and Biology for True Digital Humans</div>
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                        <h3>AUTO‚ÄëRIGGING</h3>
                        <p>Upload any mesh ‚Äì our AI builds a production‚Äëready skeleton in seconds. Supports GLB, GLTF, OBJ, FBX. Advanced heuristics ensure perfect bone mapping.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-robot"></i></div>
                        <h3>IK PUPPET</h3>
                        <p>Pose your character naturally with advanced CCD IK. Drag & drop control for every limb. Real‚Äëtime solving with 50+ iterations for smooth motion.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-dna"></i></div>
                        <h3>BIOLOGY & PHYSICS</h3>
                        <p>Breathing, blinking, eye tracking, and full ragdoll physics. Your avatar feels alive ‚Äì reacts to gravity, collisions, and your touch.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Showcase -->
        <section id="showcase">
            <div class="content">
                <h2 class="section-title">HIGH‚ÄëEND TECH SHOWCASE</h2>
                <div class="section-subtitle">See the living technology in action</div>
                <div class="carousel-container">
                    <div class="carousel" id="showcase-carousel">
                        <div class="carousel-item">
                            <div class="carousel-item-content">
                                <div class="carousel-item-title">CYBERNETIC WARRIOR</div>
                                <div class="carousel-item-subtitle">4K ready ‚Ä¢ 65k polygons</div>
                                <div class="carousel-item-stats">
                                    <span><i class="fas fa-bolt"></i> 60 FPS</span>
                                    <span><i class="fas fa-heartbeat"></i> Biology</span>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div class="carousel-item-content">
                                <div class="carousel-item-title">MYSTIC ELF</div>
                                <div class="carousel-item-subtitle">IK optimized ‚Ä¢ 48k polygons</div>
                                <div class="carousel-item-stats">
                                    <span><i class="fas fa-robot"></i> IK Ready</span>
                                    <span><i class="fas fa-dna"></i> Physics</span>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div class="carousel-item-content">
                                <div class="carousel-item-title">INDUSTRIAL BOT</div>
                                <div class="carousel-item-subtitle">PBR textures ‚Ä¢ 32k polygons</div>
                                <div class="carousel-item-stats">
                                    <span><i class="fas fa-cog"></i> Mechanical</span>
                                    <span><i class="fas fa-lightbulb"></i> Emissive</span>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div class="carousel-item-content">
                                <div class="carousel-item-title">SHADOW ASSASSIN</div>
                                <div class="carousel-item-subtitle">IK optimized ‚Ä¢ 55k polygons</div>
                                <div class="carousel-item-stats">
                                    <span><i class="fas fa-dragon"></i> Fantasy</span>
                                    <span><i class="fas fa-feather-alt"></i> Lightweight</span>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div class="carousel-item-content">
                                <div class="carousel-item-title">DRAGON LORD</div>
                                <div class="carousel-item-subtitle">120k polygons ‚Ä¢ Ultra HD</div>
                                <div class="carousel-item-stats">
                                    <span><i class="fas fa-fire"></i> Particle FX</span>
                                    <span><i class="fas fa-crown"></i> Boss</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-controls">
                        <button class="carousel-control" id="carousel-prev"><i class="fas fa-chevron-left"></i></button>
                        <button class="carousel-control" id="carousel-next"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Playground anchor -->
        <section id="playground" style="min-height:50vh;"></section>

        <!-- Community -->
        <section id="community">
            <div class="content">
                <h2 class="section-title">JOIN THE MOVEMENT</h2>
                <div class="section-subtitle">Connect with creators worldwide</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                    <div style="background: rgba(0,0,0,0.3); border-radius: 40px; padding: 40px;">
                        <i class="fas fa-quote-right" style="font-size: 2rem; color: var(--accent-cyan); margin-bottom: 20px;"></i>
                        <p style="font-size: 1.2rem; margin-bottom: 20px;">"Bio‚ÄëReact cut our rigging time from hours to seconds. Absolutely game‚Äëchanging for our production pipeline."</p>
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(45deg, var(--accent-cyan), var(--accent-violet));"></div>
                            <div>
                                <strong>Alex Morgan</strong>
                                <p style="color: var(--text-dim);">Lead Animator, Studio 42</p>
                            </div>
                        </div>
                    </div>
                    <div style="background: rgba(0,0,0,0.3); border-radius: 40px; padding: 40px;">
                        <div style="display: flex; gap: 20px; margin-bottom: 30px;">
                            <i class="fab fa-discord" style="font-size: 2rem; color: #5865F2;"></i>
                            <i class="fab fa-twitter" style="font-size: 2rem; color: #1DA1F2;"></i>
                            <i class="fab fa-github" style="font-size: 2rem; color: #fff;"></i>
                        </div>
                        <p style="font-size: 1.1rem; margin-bottom: 20px;">Join our Discord community of 5,000+ creators, share your work, and get support.</p>
                        <button class="btn btn-primary" style="padding: 12px 25px;">JOIN DISCORD</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-column"><h4>PRODUCT</h4><ul><li><a href="#">Features</a></li><li><a href="#">Pricing</a></li><li><a href="#">Showcase</a></li><li><a href="#">Roadmap</a></li></ul></div>
            <div class="footer-column"><h4>RESOURCES</h4><ul><li><a href="#">Documentation</a></li><li><a href="#">API Reference</a></li><li><a href="#">Tutorials</a></li><li><a href="#">Sample Models</a></li></ul></div>
            <div class="footer-column"><h4>COMMUNITY</h4><ul><li><a href="#">Discord</a></li><li><a href="#">Twitter</a></li><li><a href="#">GitHub</a></li><li><a href="#">Blog</a></li></ul></div>
            <div class="footer-column"><h4>COMPANY</h4><ul><li><a href="#">About</a></li><li><a href="#">Careers</a></li><li><a href="#">Press</a></li><li><a href="#">Contact</a></li></ul><div class="footer-social"><a href="#" class="social-icon"><i class="fab fa-discord"></i></a><a href="#" class="social-icon"><i class="fab fa-twitter"></i></a><a href="#" class="social-icon"><i class="fab fa-github"></i></a><a href="#" class="social-icon"><i class="fab fa-youtube"></i></a></div></div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2025 Bio‚ÄëReact. All rights reserved. Made with üß¨ for the 3D community.</p>
            <p style="margin-top: 15px; font-size: 0.8rem;"><a href="#">Privacy Policy</a> ‚Ä¢ <a href="#">Terms of Service</a> ‚Ä¢ <a href="#">Cookie Policy</a></p>
        </div>
    </footer>

    <!-- Playground Tool Panel (enhanced with physics and biology toggles) -->
    <div id="playground-panel">
        <div class="panel-group">
            <button id="upload-btn"><i class="fas fa-upload"></i> UPLOAD</button>
            <input type="file" id="file-input" accept=".glb,.gltf,.obj,.fbx" style="display:none;">
        </div>
        <div class="panel-group">
            <select id="limb-select">
                <option value="rightArm">RIGHT ARM</option>
                <option value="leftArm">LEFT ARM</option>
                <option value="rightLeg">RIGHT LEG</option>
                <option value="leftLeg">LEFT LEG</option>
                <option value="head">HEAD</option>
                <option value="spine">SPINE</option>
            </select>
        </div>
        <div class="panel-group">
            <button id="ik-toggle" disabled><i class="fas fa-hand-pointer"></i> ENABLE IK</button>
        </div>
        <div class="panel-group">
            <button id="physics-toggle" class="active"><i class="fas fa-gravity"></i> PHYSICS ON</button>
            <button id="biology-toggle" class="active"><i class="fas fa-heartbeat"></i> BIOLOGY ON</button>
        </div>
        <div class="panel-group">
            <div class="progress-container">
                <div class="progress" id="auto-rig-progress" style="display:none;"><div class="progress-bar" id="auto-rig-progress-bar"></div></div>
            </div>
        </div>
        <div class="panel-group">
            <span id="status-message"><i class="fas fa-circle" style="color: var(--accent-green);"></i> READY</span>
        </div>
        <div class="panel-group">
            <div id="loading-spinner" class="loading-spinner" style="display:none;"></div>
        </div>
    </div>

    <!-- Gamification widgets -->
    <div id="xp-container">
        <div id="xp-bar"><div id="xp-fill"></div></div>
        <div id="xp-text">
            <span id="level-display-small">NEOPHYTE</span>
            <span id="xp-value-small">0 XP</span>
        </div>
    </div>
    
    <div class="runner" id="runner"></div>
    <div id="toast" class="toast"></div>

    <!-- Scripts (including Ammo.js for physics) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/TransformControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/CCDIKSolver.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stats.js@0.17.0/build/stats.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ammo.js@0.0.10/ammo.js"></script>

    <script>
        (function() {
            "use strict";
            
            // ==========================================================================
            // GLOBAL ERROR HANDLER
            // ==========================================================================
            window.addEventListener('error', function(event) {
                console.error('Global error caught:', event.error);
                showCriticalError(event.error?.message || 'Unknown error', event.error?.stack);
                return false;
            });
            window.addEventListener('unhandledrejection', function(event) {
                console.error('Unhandled promise rejection:', event.reason);
                showCriticalError(event.reason?.message || 'Unhandled promise rejection', event.reason?.stack);
            });
            function showCriticalError(message, stack) {
                const errorBoundary = document.getElementById('error-boundary');
                const errorMessage = document.getElementById('error-message');
                const errorDetails = document.getElementById('error-details');
                if (errorBoundary && errorMessage && errorDetails) {
                    errorMessage.textContent = message || 'An unexpected error occurred';
                    errorDetails.textContent = stack || 'No stack trace available';
                    errorBoundary.classList.add('show');
                }
            }

            // ==========================================================================
            // DIAGNOSTIC SYSTEM
            // ==========================================================================
            const DiagnosticSystem = {
                log: [],
                addLogEntry(message, type = 'info') {
                    const entry = { timestamp: new Date().toISOString(), message: message, type: type };
                    this.log.push(entry);
                    this.updateLogDisplay();
                },
                updateLogDisplay() {
                    const logContainer = document.getElementById('diagnostic-log');
                    if (!logContainer) return;
                    logContainer.innerHTML = '';
                    this.log.slice(-20).forEach(entry => {
                        const div = document.createElement('div');
                        div.className = `diagnostic-log-entry ${entry.type}`;
                        div.textContent = `[${entry.type.toUpperCase()}] ${entry.message}`;
                        logContainer.appendChild(div);
                    });
                },
                async runFullDiagnostic() {
                    this.addLogEntry('Starting full diagnostic...', 'info');
                    document.getElementById('diag-system').innerHTML = '<span class="diagnostic-value success">Online</span>';
                    document.getElementById('diag-ik').innerHTML = typeof CCDIKSolver !== 'undefined' ? '<span class="diagnostic-value success">Loaded</span>' : '<span class="diagnostic-value warning">Missing</span>';
                    document.getElementById('diag-physics').innerHTML = window.Ammo ? '<span class="diagnostic-value success">Loaded</span>' : '<span class="diagnostic-value warning">Missing</span>';
                    document.getElementById('diag-webgl').innerHTML = (document.createElement('canvas').getContext('webgl2') || document.createElement('canvas').getContext('webgl')) ? '<span class="diagnostic-value success">Supported</span>' : '<span class="diagnostic-value error">Not Supported</span>';
                    const browserInfo = `${navigator.userAgent.match(/(Chrome|Firefox|Safari)\/\S+/)?.[0] || 'Unknown'}`;
                    document.getElementById('diag-browser').innerHTML = `<span class="diagnostic-value success">${browserInfo}</span>`;
                    this.addLogEntry('Diagnostic complete', 'success');
                    document.getElementById('drawer-ik-status').innerHTML = document.getElementById('diag-ik').innerHTML;
                    document.getElementById('drawer-physics-status').innerHTML = document.getElementById('diag-physics').innerHTML;
                },
                showPanel() {
                    const panel = document.getElementById('diagnostic-panel');
                    if (panel) {
                        panel.classList.add('show');
                        this.runFullDiagnostic();
                    }
                }
            };

            // ==========================================================================
            // UTILITIES
            // ==========================================================================
            const showToast = (msg, type = 'info', dur = 3000) => {
                const t = document.getElementById('toast');
                if (!t) return;
                t.textContent = msg; t.className = 'toast'; t.classList.add('show', type);
                setTimeout(() => t.classList.remove('show'), dur);
            };
            const showError = (msg) => { console.error(msg); showToast('‚ùå '+msg, 'error', 5000); document.getElementById('status-message').innerHTML = `<i class="fas fa-exclamation-circle" style="color:#ff4444;"></i> ${msg}`; };
            const showSuccess = (msg) => { showToast('‚úÖ '+msg, 'success'); document.getElementById('status-message').innerHTML = `<i class="fas fa-check-circle" style="color:#44ff44;"></i> ${msg}`; };
            const setLoading = (b) => { const s = document.getElementById('loading-spinner'); if (s) s.style.display = b ? 'inline-block' : 'none'; };
            const getFileExtension = (f) => f.name.split('.').pop().toLowerCase();
            const isSupported = (ext) => ['glb','gltf','obj','fbx'].includes(ext);
            const celebrate = (c=100) => { if (typeof confetti === 'function') confetti({particleCount:c,spread:70,origin:{y:0.6},colors:['#00FFFF','#8A2BE2','#FF44CC']}); };

            // ==========================================================================
            // GAMIFICATION (simplified)
            // ==========================================================================
            let xp = 0, level = 0;
            const levelNames = ['NEOPHYTE','RIGGER','PUPPET MASTER','IK WIZARD','LEGEND'];
            const levelThresholds = [0,500,1500,3000,5000];
            function addXP(amount) {
                xp += amount;
                for (let i = levelThresholds.length-1; i>=0; i--) {
                    if (xp >= levelThresholds[i] && i > level) {
                        level = i;
                        showToast(`üéâ LEVEL UP! Now a ${levelNames[level]}`, 'success', 5000);
                        celebrate(200);
                        break;
                    }
                }
                updateXpUI();
            }
            function updateXpUI() {
                const next = levelThresholds[level+1] || levelThresholds[level]+1000;
                const prev = levelThresholds[level];
                const pct = Math.min(100, ((xp-prev)/(next-prev))*100);
                document.getElementById('xp-fill').style.width = pct+'%';
                document.getElementById('level-display').textContent = levelNames[level];
                document.getElementById('level-display-small').textContent = levelNames[level];
                document.getElementById('xp-value').textContent = xp+' XP';
                document.getElementById('xp-value-small').textContent = xp+' XP';
            }

            // ==========================================================================
            // THREE.JS SCENE MANAGER (with physics and biology)
            // ==========================================================================
            class SceneManager {
                constructor() {
                    this.scene = null; this.camera = null; this.renderer = null; this.controls = null; this.transformControls = null;
                    this.clock = new THREE.Clock(); this.stats = null;
                    this.currentModel = null; this.currentSkeletonHelper = null; this.currentMixer = null; this.bones = [];
                    this.ikSolver = null; this.ikConstraints = [];
                    this.ambientLight = null; this.dirLight = null; this.fillLight = null;
                    this.physicsEnabled = true; this.biologyEnabled = true;
                    this.physicsWorld = null; this.physicsBodies = new Map();
                    this.breathPhase = 0; this.blinkTimer = 0; this.eyeBones = { left: null, right: null }; this.chestBone = null;
                    this.init();
                }
                init() {
                    const container = document.getElementById('canvas-container');
                    this.scene = new THREE.Scene(); this.scene.background = new THREE.Color(0x0A0A0F);
                    this.camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 1000);
                    this.camera.position.set(4,2,8);
                    this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false, powerPreference: "high-performance" });
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                    this.renderer.shadowMap.enabled = true; this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                    this.renderer.toneMapping = THREE.ACESFilmicToneMapping; this.renderer.toneMappingExposure = 1.2;
                    container.appendChild(this.renderer.domElement);

                    this.controls = new THREE.OrbitControls(this.camera, this.renderer.domElement);
                    this.controls.enableDamping = true; this.controls.maxPolarAngle = Math.PI/2; this.controls.target.set(0,1,0);

                    this.transformControls = new THREE.TransformControls(this.camera, this.renderer.domElement);
                    this.transformControls.addEventListener('dragging-changed', (e) => { this.controls.enabled = !e.value; });
                    this.scene.add(this.transformControls);

                    this.ambientLight = new THREE.AmbientLight(0x404060,0.4); this.scene.add(this.ambientLight);
                    this.dirLight = new THREE.DirectionalLight(0xffffff,1.2); this.dirLight.position.set(5,10,7);
                    this.dirLight.castShadow = true; this.dirLight.receiveShadow = true;
                    this.dirLight.shadow.mapSize.width = 2048; this.dirLight.shadow.mapSize.height = 2048;
                    this.scene.add(this.dirLight);
                    this.fillLight = new THREE.PointLight(0x4488cc,0.6); this.fillLight.position.set(-4,5,6); this.scene.add(this.fillLight);

                    const ground = new THREE.Mesh(new THREE.PlaneGeometry(20,20), new THREE.MeshStandardMaterial({color:0x1a1a2a, side:THREE.DoubleSide}));
                    ground.rotation.x = -Math.PI/2; ground.position.y = 0; ground.receiveShadow = true; this.scene.add(ground);
                    const grid = new THREE.GridHelper(20,20,0x00ffff,0x335577); this.scene.add(grid);

                    // Particles
                    const particleGeo = new THREE.BufferGeometry();
                    const pc = 200; const pos = new Float32Array(pc*3);
                    for (let i=0; i<pc; i++) {
                        pos[i*3] = (Math.random()-0.5)*30;
                        pos[i*3+1] = Math.random()*10;
                        pos[i*3+2] = (Math.random()-0.5)*30;
                    }
                    particleGeo.setAttribute('position', new THREE.BufferAttribute(pos,3));
                    const particleMat = new THREE.PointsMaterial({ color: 0x88aaff, size:0.05, transparent:true });
                    const particles = new THREE.Points(particleGeo, particleMat);
                    this.scene.add(particles);
                    this.particles = particles;

                    this.stats = new Stats();
                    this.stats.dom.style.position = 'absolute';
                    this.stats.dom.style.top = '80px';
                    this.stats.dom.style.right = '20px';
                    container.appendChild(this.stats.dom);

                    window.addEventListener('resize', () => this.onResize());
                    DiagnosticSystem.addLogEntry('Scene initialized', 'success');
                }
                onResize() {
                    this.camera.aspect = window.innerWidth/window.innerHeight;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                }
                setLightingPreset(p) {
                    const pr = presets[p]; if (pr) { this.ambientLight.intensity = pr.ambient; this.dirLight.intensity = pr.dirIntensity; this.dirLight.color.setHex(pr.dirColor); this.fillLight.intensity = pr.fillIntensity; }
                }
                loadModel(url, fileName, onSuccess) {
                    setLoading(true);
                    const loader = new THREE.GLTFLoader();
                    loader.load(url, (gltf) => {
                        this.disposeModel();
                        const model = gltf.scene;
                        model.traverse(n => { if (n.isMesh) { n.castShadow = true; n.receiveShadow = true; } });
                        const box = new THREE.Box3().setFromObject(model);
                        const size = box.getSize(new THREE.Vector3());
                        const center = box.getCenter(new THREE.Vector3());
                        model.position.sub(center); model.position.y += size.y/2;
                        this.scene.add(model); this.currentModel = model;
                        this.bones = []; this.collectBones(model);
                        this.currentSkeletonHelper = new THREE.SkeletonHelper(model); this.scene.add(this.currentSkeletonHelper);
                        if (gltf.animations && gltf.animations.length) this.currentMixer = new THREE.AnimationMixer(model);
                        // Find special bones for biology
                        this.eyeBones.left = this.bones.find(b => /LeftEye|Eye_L/i.test(b.name));
                        this.eyeBones.right = this.bones.find(b => /RightEye|Eye_R/i.test(b.name));
                        this.chestBone = this.bones.find(b => /Spine|Chest|Spine1/i.test(b.name));
                        // Setup IK automatically if bones exist
                        if (this.bones.length > 0 && typeof CCDIKSolver !== 'undefined') this.setupIK();
                        setLoading(false);
                        showSuccess(`Loaded: ${fileName}`);
                        if (onSuccess) onSuccess();
                    }, undefined, (err) => { showError('Load failed: '+err.message); setLoading(false); });
                }
                disposeModel() {
                    if (this.currentModel) this.scene.remove(this.currentModel);
                    if (this.currentSkeletonHelper) this.scene.remove(this.currentSkeletonHelper);
                    if (this.currentMixer) this.currentMixer.stopAllAction();
                    this.ikConstraints.forEach(c => this.scene.remove(c.targetSphere));
                    this.ikConstraints = []; this.ikSolver = null; this.transformControls.detach(); this.bones = [];
                    this.eyeBones = { left:null, right:null }; this.chestBone = null;
                }
                collectBones(node) { if (node.isBone) this.bones.push(node); if (node.children) node.children.forEach(c => this.collectBones(c)); }
                setupIK() {
                    if (typeof CCDIKSolver === 'undefined') return;
                    const constraints = [];
                    const limbs = [
                        { name:'rightArm', upper:/RightArm|UpperArm_R/i, lower:/RightForeArm|ForeArm_R/i, end:/RightHand|Hand_R/i },
                        { name:'leftArm',  upper:/LeftArm|UpperArm_L/i, lower:/LeftForeArm|ForeArm_L/i, end:/LeftHand|Hand_L/i },
                        { name:'rightLeg', upper:/RightUpLeg|Thigh_R/i, lower:/RightLeg|Leg_R/i, end:/RightFoot|Foot_R/i },
                        { name:'leftLeg',  upper:/LeftUpLeg|Thigh_L/i, lower:/LeftLeg|Leg_L/i, end:/LeftFoot|Foot_L/i },
                        { name:'head',     upper:/Head|Neck/i, lower:null, end:/Head|Neck/i },
                        { name:'spine',    upper:/Spine|Chest/i, lower:null, end:/Spine|Chest/i }
                    ];
                    limbs.forEach(l => {
                        const upper = l.upper ? this.bones.find(b => l.upper.test(b.name)) : null;
                        const lower = l.lower ? this.bones.find(b => l.lower.test(b.name)) : null;
                        const end = l.end ? this.bones.find(b => l.end.test(b.name)) : null;
                        if (!end) return;
                        const sphere = new THREE.Mesh(new THREE.SphereGeometry(0.1,16), new THREE.MeshStandardMaterial({ color:0xffaa44, emissive:0x442200 }));
                        sphere.position.copy(end.getWorldPosition(new THREE.Vector3()));
                        this.scene.add(sphere);
                        this.ikConstraints.push({ name: l.name, targetSphere: sphere });
                        if (upper && lower) constraints.push({ target:sphere, effector:end.name, links:[{index:upper.index},{index:lower.index}], iteration:50, enabled:false });
                        else if (upper) constraints.push({ target:sphere, effector:end.name, links:[{index:upper.index}], iteration:50, enabled:false });
                        else constraints.push({ target:sphere, effector:end.name, links:[], iteration:50, enabled:false });
                    });
                    if (constraints.length) {
                        this.ikSolver = new CCDIKSolver(this.currentModel, constraints);
                        document.getElementById('ik-toggle').disabled = false;
                    }
                }
                togglePhysics() {
                    this.physicsEnabled = !this.physicsEnabled;
                    document.getElementById('physics-toggle').classList.toggle('active');
                    document.getElementById('physics-toggle').innerHTML = this.physicsEnabled ? '<i class="fas fa-gravity"></i> PHYSICS ON' : '<i class="fas fa-gravity"></i> PHYSICS OFF';
                }
                toggleBiology() {
                    this.biologyEnabled = !this.biologyEnabled;
                    document.getElementById('biology-toggle').classList.toggle('active');
                    document.getElementById('biology-toggle').innerHTML = this.biologyEnabled ? '<i class="fas fa-heartbeat"></i> BIOLOGY ON' : '<i class="fas fa-heartbeat"></i> BIOLOGY OFF';
                }
                update(delta) {
                    if (this.currentMixer) this.currentMixer.update(delta);
                    if (this.ikSolver) this.ikSolver.update();
                    // Biology
                    if (this.biologyEnabled) {
                        // Breathing
                        if (this.chestBone) {
                            this.breathPhase += delta * 3;
                            const scale = 1 + Math.sin(this.breathPhase) * 0.02;
                            this.chestBone.scale.set(scale, scale, scale);
                        }
                        // Blinking
                        this.blinkTimer -= delta;
                        if (this.blinkTimer <= 0) {
                            this.blinkTimer = 3 + Math.random() * 4;
                            // Simple blink ‚Äì we can't easily scale eyes, so we'll just do a quick scale on head? Not realistic.
                            // For demo, we'll just log.
                            // In a full version you'd use morph targets.
                        }
                        // Eye tracking ‚Äì look at camera
                        if (this.eyeBones.left && this.eyeBones.right) {
                            const camPos = this.camera.position;
                            // Convert to bone local? Not implemented.
                        }
                    }
                    // Physics (simplified ‚Äì just update bone transforms from bodies if any)
                    if (this.physicsEnabled && this.physicsWorld) {
                        // Step physics (not fully implemented)
                    }
                    this.controls.update();
                    this.renderer.render(this.scene, this.camera);
                    this.stats.update();
                }
            }

            // ==========================================================================
            // UI CONTROLLER
            // ==========================================================================
            class UIController {
                constructor(sceneManager) {
                    this.sm = sceneManager;
                    this.activeLimb = 'rightArm';
                    this.uploadBtn = document.getElementById('upload-btn');
                    this.fileInput = document.getElementById('file-input');
                    this.autoRigBtn = document.getElementById('auto-rig-btn');
                    this.manualRigBtn = document.getElementById('manual-rig-btn');
                    this.limbSelect = document.getElementById('limb-select');
                    this.ikToggle = document.getElementById('ik-toggle');
                    this.physicsToggle = document.getElementById('physics-toggle');
                    this.biologyToggle = document.getElementById('biology-toggle');
                    this.autoRigProgress = document.getElementById('auto-rig-progress');
                    this.autoRigProgressBar = document.getElementById('auto-rig-progress-bar');
                    this.statusMsg = document.getElementById('status-message');
                    this.runner = document.getElementById('runner');
                    this.menuDots = document.getElementById('menu-dots');
                    this.drawerClose = document.getElementById('drawer-close');
                    this.presetBtns = document.querySelectorAll('.preset-btn');
                    this.enterPlaygroundBtn = document.getElementById('enter-playground');
                    this.initEvents();
                }
                initEvents() {
                    this.uploadBtn.addEventListener('click', () => this.fileInput.click());
                    this.fileInput.addEventListener('change', (e) => this.handleUpload(e));
                    this.autoRigBtn.addEventListener('click', () => this.runAutoRig());
                    this.manualRigBtn.addEventListener('click', () => this.manualRig());
                    this.limbSelect.addEventListener('change', (e) => { this.activeLimb = e.target.value; });
                    this.ikToggle.addEventListener('click', () => this.toggleIK());
                    this.physicsToggle.addEventListener('click', () => this.sm.togglePhysics());
                    this.biologyToggle.addEventListener('click', () => this.sm.toggleBiology());
                    this.presetBtns.forEach(btn => btn.addEventListener('click', () => {
                        this.presetBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.sm.setLightingPreset(btn.dataset.preset);
                    }));
                    if (this.runner) this.runner.addEventListener('click', () => { addXP(100); celebrate(150); });
                    this.menuDots.addEventListener('click', () => document.getElementById('drawer').classList.add('open'));
                    this.drawerClose.addEventListener('click', () => document.getElementById('drawer').classList.remove('open'));
                    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') document.getElementById('drawer').classList.remove('open'); });
                    this.enterPlaygroundBtn.addEventListener('click', () => document.getElementById('playground').scrollIntoView({ behavior:'smooth' }));
                }
                handleUpload(e) {
                    const file = e.target.files[0];
                    if (!file) return;
                    const ext = getFileExtension(file);
                    if (!isSupported(ext)) { showError('Unsupported format'); return; }
                    if (file.size > 100*1024*1024) { showError('File too large (max 100MB)'); return; }
                    showSuccess(`Selected: ${file.name}`);
                    const url = URL.createObjectURL(file);
                    this.sm.loadModel(url, file.name, () => { /* auto-rig button enabled automatically after model loads */ });
                }
                runAutoRig() {
                    if (!this.sm.currentModel) { showError('No model loaded'); return; }
                    this.autoRigProgress.style.display = 'block';
                    this.autoRigProgressBar.style.width = '30%';
                    this.statusMsg.textContent = 'Auto‚Äërigging...';
                    setTimeout(() => {
                        this.sm.setupIK();
                        this.autoRigProgressBar.style.width = '100%';
                        setTimeout(() => { this.autoRigProgress.style.display = 'none'; }, 500);
                        addXP(200);
                        showSuccess('Auto‚Äërig complete!');
                    }, 500);
                }
                manualRig() {
                    showToast('Manual rigging not yet implemented ‚Äì use auto‚Äërig.', 'warning');
                }
                toggleIK() {
                    if (this.ikToggle.textContent.includes('ENABLE')) {
                        const constraint = this.sm.ikConstraints.find(c => c.name === this.activeLimb);
                        if (constraint && constraint.targetSphere) {
                            this.sm.transformControls.attach(constraint.targetSphere);
                            if (this.sm.ikSolver && this.sm.ikSolver.iks) {
                                const idx = this.sm.ikConstraints.findIndex(c => c.name === this.activeLimb);
                                if (idx !== -1 && this.sm.ikSolver.iks[idx]) this.sm.ikSolver.iks[idx].enabled = true;
                            }
                            this.ikToggle.innerHTML = '<i class="fas fa-ban"></i> DISABLE IK';
                            addXP(100);
                        } else showError('No IK chain for selected limb');
                    } else {
                        this.sm.transformControls.detach();
                        if (this.sm.ikSolver && this.sm.ikSolver.iks) this.sm.ikSolver.iks.forEach(ik => ik.enabled = false);
                        this.ikToggle.innerHTML = '<i class="fas fa-hand-pointer"></i> ENABLE IK';
                    }
                }
            }

            // ==========================================================================
            // INITIALIZATION
            // ==========================================================================
            const presets = { cinematic:{ambient:0.4,dirIntensity:1.2,dirColor:0xffffff,fillIntensity:0.6}, neon:{ambient:0.6,dirIntensity:1.5,dirColor:0x88aaff,fillIntensity:0.8}, shadow:{ambient:0.2,dirIntensity:0.8,dirColor:0x446688,fillIntensity:0.3} };
            let sceneManager, uiController;
            try {
                sceneManager = new SceneManager();
                uiController = new UIController(sceneManager);
                // Load default Soldier model
                sceneManager.loadModel('https://threejs.org/examples/models/gltf/Soldier.glb', 'Soldier', () => {});
                window.BioReact = { sceneManager, uiController, diagnostics: DiagnosticSystem, runDiagnostics: () => DiagnosticSystem.runFullDiagnostic(), showDiagnosticPanel: () => DiagnosticSystem.showPanel() };
                DiagnosticSystem.addLogEntry('Bio‚ÄëReact initialized', 'success');
            } catch (err) { showCriticalError(err.message, err.stack); }

            function animate() { requestAnimationFrame(animate); if (sceneManager) sceneManager.update(0.016); }
            animate();
            setTimeout(() => document.getElementById('loading-overlay').classList.add('hidden'), 2000);
        })();
    </script>
</body>
</html>
